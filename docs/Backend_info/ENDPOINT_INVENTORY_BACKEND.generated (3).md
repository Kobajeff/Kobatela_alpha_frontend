# Backend Endpoint Inventory (Block 1) — Generated

Scope: core escrow (sender UX), admin review queue, admin settings. FE3/fraud-config endpoints are intentionally excluded.

## Escrow (Sender Core)
| Method | Path | Scopes | Request schema | Response schema | Response keys (top-level → nested) |
| --- | --- | --- | --- | --- | --- |
| GET | `/escrows` | Router: `app/routers/escrow.py`; ABAC: `mine=true` enforces `escrow.sender_user_id == api_key.user_id`, otherwise `escrow.sender_user_id == api_key.user_id` **or** `escrow.provider_user_id == api_key.user_id` | Query: `mine`, `status`, `sender_id`, `provider_id`, `advisor_id`, `limit`, `offset` | `list[EscrowListItem]` **or** `PaginatedResponse[EscrowListItem]` | `items`, `total`, `limit`, `offset` → `EscrowListItem.{id,status,amount_total,currency,deadline_at,created_at,provider_user_id,provider_id,beneficiary_id}` (or list of EscrowListItem when `mine=true`) |
| POST | `/escrows` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` (payload sender_user_id must match authenticated user) | `EscrowCreate` | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| POST | `/escrows/{escrow_id}/activate` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `EscrowActivateRequest` (optional) | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| POST | `/escrows/{escrow_id}/deposit` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `EscrowDepositCreate` + `Idempotency-Key` | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| POST | `/escrows/{escrow_id}/funding-session` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | — | `FundingSessionRead` | `FundingSessionRead.{funding_id,client_secret}` |
| POST | `/escrows/{escrow_id}/mark-delivered` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `EscrowActionPayload` | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| POST | `/escrows/{escrow_id}/client-approve` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `EscrowActionPayload` (optional) | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| POST | `/escrows/{escrow_id}/client-reject` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `EscrowActionPayload` (optional) | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| POST | `/escrows/{escrow_id}/check-deadline` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | — | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| GET | `/escrows/{escrow_id}` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` **or** `escrow.provider_user_id == api_key.user_id` | — | `EscrowRead` | `EscrowRead.{id,client_id,provider_user_id,provider_id,beneficiary_id,beneficiary_profile (redacted by viewer context),merchant_registry_id,merchant_suggestion_id,amount_total,currency,status,domain,release_conditions_json,deadline_at}` |
| GET | `/escrows/{escrow_id}/summary` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` **or** `escrow.provider_user_id == api_key.user_id` | — | `SenderEscrowSummary` | `SenderEscrowSummary.{escrow,milestones,proofs,payments,viewer_context,current_submittable_milestone_id,current_submittable_milestone_idx,pricing_summary}` → `EscrowRead (beneficiary_profile redacted by viewer context)`, `MilestoneProviderRead[]`, `ProofRead[] (redacted by viewer context)`, `PaymentRead[] (redacted by viewer context)`, `EscrowViewerContextRead.{relation,is_sender,is_provider,is_participant,viewer_user_id,allowed_actions}`, `PricingSummaryRead.{currency,amount_total,milestones,pricing_flags,last_computed_at}` |
| POST | `/escrows/{escrow_id}/milestones` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `MilestoneCreate` | `MilestoneRead` | `MilestoneRead.{id,escrow_id,label,amount,currency,sequence_index,status,proof_kind,proof_requirements}` |
| GET | `/escrows/{escrow_id}/milestones` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` **or** `escrow.provider_user_id == api_key.user_id` | — | `list[MilestoneProviderRead]` | `MilestoneProviderRead.{id,escrow_id,sequence_index,label,amount,currency,status,proof_kind}` |
| GET | `/escrows/milestones/{milestone_id}` | Router: `app/routers/escrow.py`; ABAC: `escrow.sender_user_id == api_key.user_id` **or** `escrow.provider_user_id == api_key.user_id` | — | `MilestoneRead` | `MilestoneRead.{id,escrow_id,label,amount,currency,sequence_index,status,proof_kind,proof_requirements (null unless escrow.sender_user_id == api_key.user_id)}` |
| POST | `/sender/escrows/{escrow_id}/milestones` | Router: `app/routers/sender_escrow_milestones.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | `MilestoneCreate` | `MilestoneRead` | `MilestoneRead.{id,escrow_id,label,amount,currency,sequence_index,status,proof_kind,proof_requirements}` |
| GET | `/sender/escrows/{escrow_id}/milestones` | Router: `app/routers/sender_escrow_milestones.py`; ABAC: `escrow.sender_user_id == api_key.user_id` | — | `list[MilestoneRead]` | `MilestoneRead.{id,escrow_id,label,amount,currency,sequence_index,status,proof_kind,proof_requirements}` |

## Admin Review Queue
| Method | Path | Scopes | Request schema | Response schema | Response keys (top-level → nested) |
| --- | --- | --- | --- | --- | --- |
| GET | `/admin/proofs/review-queue` | Router: `app/routers/admin_tools.py`; ops-only via `ApiScope.admin`/`ApiScope.support` (NOT FE-USED) | Query: `advisor_id`, `unassigned_only`, `sender_id`, `provider_id`, `review_mode`, `status`, `limit`, `offset` | `PaginatedResponse[AdminProofReviewItem]` | `items`, `total`, `limit`, `offset` → `AdminProofReviewItem.{proof_id,escrow_id,milestone_id,status,type,storage_key,storage_url,sha256,created_at,invoice_total_amount,invoice_currency,ai_risk_level,ai_score,ai_flags,ai_explanation,ai_checked_at,ai_reviewed_by,ai_reviewed_at,metadata,advisor,payout_eligible,payout_blocked_reasons}` → `AdvisorSummary.{id,advisor_id,first_name,last_name,email,phone,country,language,advisor_grade,advisor_review,sender_managed,total_number_of_case_managed}` |

## Admin Settings
| Method | Path | Scopes | Request schema | Response schema | Response keys (top-level → nested) |
| --- | --- | --- | --- | --- | --- |
| GET | `/admin/settings/ai-proof` | Router: `app/routers/admin_settings.py`; ops-only via `ApiScope.admin` (NOT FE-USED) | — | Inline object | `{key,value,effective}` |
| POST | `/admin/settings/ai-proof` | Router: `app/routers/admin_settings.py`; ops-only via `ApiScope.admin` (NOT FE-USED) | Query: `enabled` (bool) | Inline object | `{key,value}` |
