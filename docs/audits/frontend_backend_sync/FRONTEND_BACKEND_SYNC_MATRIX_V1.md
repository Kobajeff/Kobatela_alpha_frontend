# FRONTEND_BACKEND_SYNC_MATRIX_V1

## Backend Contract Inventory vs Frontend Usage

| Backend endpoint (METHOD PATH) | Doc source file | Auth mechanism in docs | Expected roles/scopes | Request schema (doc) | Response schema (doc) | Frontend usage status | Frontend call sites | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| POST /auth/login | docs/Backend_info/API_GUIDE (11).md | Public | — | AuthLoginRequest | AuthLoginResponse | USED | `useLogin`【F:src/lib/queries/sender.ts†L140-L170】 | UI sends email only; optional scope param unused. |
| GET /auth/me | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/admin/advisor | — | AuthMeResponse | USED | `useAuthMe`【F:src/lib/queries/sender.ts†L205-L242】 | Retry stops on 401/403; 404 treated as session reset. |
| GET /me/profile | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | sender/provider/admin/support | — | UserProfileRead | USED | `useUserProfile`【F:src/lib/queries/sender.ts†L244-L274】 | No client masking beyond backend. |
| PATCH /me/profile | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | sender/provider/admin/support | UserProfileUpdate | UserProfileRead | USED | `useUpdateUserProfile`【F:src/lib/queries/sender.ts†L276-L304】 | No client validation for bank/ID formats. |
| POST /users | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | UserCreate | UserRead | UNUSED | — | Admin UI does not expose generic user creation. |
| POST /users/{user_id}/psp/stripe/account-link | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin | — | StripeAccountLinkRead | UNUSED | — | Not surfaced in UI. |
| POST /users/{user_id}/stripe/sync | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | — | UserRead | UNUSED | — | Not surfaced in UI. |
| POST /admin/users | docs/Backend_info/API_GUIDE (11).md | API key | admin | AdminUserCreate | AdminUserCreateResponse | USED | `createAdminUser`【F:src/lib/adminApi.ts†L19-L38】 | Token shown after creation. |
| GET /admin/users | docs/Backend_info/API_GUIDE (11).md | API key | admin | Query (limit/offset/q/role/active) | PaginatedResponse[AdminUserListItem] | USED | `useAdminUsers`【F:src/lib/queries/admin.ts†L281-L320】 | Pagination supported. |
| GET /admin/users/{user_id} | docs/Backend_info/API_GUIDE (11).md | API key | admin | — | AdminUserDetailRead | USED | `getAdminUserById`【F:src/lib/adminApi.ts†L46-L68】 | — |
| GET /admin/users/{user_id}/api-keys | docs/Backend_info/API_GUIDE (11).md | API key | admin | Query active | list[ApiKeyRead] | USED | `getAdminUserApiKeys`【F:src/lib/adminApi.ts†L70-L91】 | — |
| POST /admin/users/{user_id}/api-keys | docs/Backend_info/API_GUIDE (11).md | API key | admin | AdminUserApiKeyCreate | AdminUserApiKeyCreateResponse | USED | `issueAdminUserApiKey`【F:src/lib/adminApi.ts†L80-L93】 | — |
| DELETE /admin/users/{user_id}/api-keys/{api_key_id} | docs/Backend_info/API_GUIDE (11).md | API key | admin | — | Empty (204) | USED | `revokeAdminUserApiKey`【F:src/lib/adminApi.ts†L93-L107】 | — |
| GET /admin/users/{user_id}/profile | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | — | UserProfileRead | UNUSED | — | Admin profile view not wired. |
| POST /beneficiaries | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | sender | BeneficiaryCreate | BeneficiaryProfilePublicRead | UNUSED | — | No beneficiary UI. |
| GET /beneficiaries/{beneficiary_id} | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | sender/provider/support/admin/advisor | — | BeneficiaryProfilePublicRead/AdminRead | UNUSED | — | No beneficiary UI. |
| POST /mandates | docs/Backend_info/FRONTEND_MANDATE_ESCROW_UX_CONTRACT (4).md | API key | sender | UsageMandateCreate | UsageMandateRead | USED | `useCreateMandate`【F:src/lib/queries/sender.ts†L118-L168】【F:src/app/sender/mandates/page.tsx†L83-L168】 | Collects on/off-platform beneficiary and merchant options. |
| GET /mandates | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin | — | list[UsageMandateRead] | UNUSED | — | No mandate list screen. |
| GET /mandates/{mandate_id} | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin | — | UsageMandateRead | USED | `useMandate`【F:src/lib/queries/sender.ts†L438-L452】 | Used for prefill. |
| POST /mandates/cleanup | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | sender | — | dict | MISUSED (maintenance) | `useCleanupMandates`【F:src/lib/queries/sender.ts†L137-L174】 | Docs mark as maintenance-only; exposed in sender UI. |
| POST /merchant-suggestions | docs/Backend_info/API_GUIDE (11).md | API key | sender | MerchantSuggestionCreate | MerchantSuggestionRead | USED | `useCreateMerchantSuggestion`【F:src/lib/queries/sender.ts†L110-L136】 | — |
| GET /merchant-suggestions | docs/Backend_info/API_GUIDE (11).md | API key | sender | Query limit/offset | list[MerchantSuggestionRead] | USED | `useMerchantSuggestionsList`【F:src/lib/queries/sender.ts†L72-L110】 | — |
| GET /merchant-suggestions/{id} | docs/Backend_info/API_GUIDE (11).md | API key | sender | — | MerchantSuggestionRead | USED | `useMerchantSuggestion`【F:src/lib/queries/sender.ts†L112-L137】 | — |
| GET /admin/merchant-suggestions | docs/Backend_info/API_GUIDE (11).md | API key | admin/support | Query status/q/limit/offset | list[MerchantSuggestionRead] | USED | `useAdminMerchantSuggestions`【F:src/lib/queries/admin.ts†L222-L273】 | — |
| POST /admin/merchant-suggestions/{id}/approve|reject|promote | docs/Backend_info/API_GUIDE (11).md | API key | admin/support | MerchantSuggestionAdminUpdate/Promote | MerchantSuggestionRead | USED | `useApproveMerchantSuggestion` / `useRejectMerchantSuggestion` / `usePromoteMerchantSuggestion`【F:src/lib/queries/admin.ts†L349-L417】 | — |
| GET /sender/dashboard | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | sender | Query limit/include_actions | SenderDashboard | USED | `useSenderDashboard`【F:src/lib/queries/sender.ts†L306-L356】 | Uses backend aggregate; no N+1. |
| GET /escrows | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support | Query mine/status/... | PaginatedResponse or list | USED | `useSenderEscrows`【F:src/lib/queries/sender.ts†L358-L405】 | Admin dashboards also use for totals. |
| POST /escrows | docs/Backend_info/API_GUIDE (11).md | API key | sender | EscrowCreate | EscrowRead | USED | `useCreateEscrow` + create page【F:src/lib/queries/sender.ts†L406-L455】【F:src/app/sender/escrows/create/page.tsx†L112-L217】 | Collects provider XOR beneficiary, release_conditions, deadline, domain. |
| GET /escrows/{escrow_id} | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin | — | EscrowRead | UNUSED | — | Detail views rely on summary route only. |
| GET /escrows/{escrow_id}/summary | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider | — | SenderEscrowSummary | MISUSED (admin context) | Sender/admin summary hooks【F:src/lib/queries/sender.ts†L472-L569】【F:src/lib/queries/admin.ts†L734-L760】 | Admin UI uses sender summary instead of `/admin/escrows/{id}/summary`. |
| GET /admin/escrows/{escrow_id}/summary | docs/Backend_info/API_GUIDE (11).md | API key | admin/support | Query proofs_limit/include_* | AdminEscrowSummaryRead | UNUSED | — | Should power admin escrow detail. |
| POST /escrows/{escrow_id}/deposit | docs/Backend_info/API_GUIDE (11).md | API key | sender | EscrowDepositCreate + Idempotency-Key | EscrowRead | USED | `useDepositEscrow`【F:src/lib/queries/sender.ts†L826-L876】 | Retries on 500 only; no CTA copy for idempotency reuse. |
| POST /escrows/{escrow_id}/funding-session | docs/Backend_info/API_GUIDE (11).md | API key | sender/admin | — | FundingSessionRead | USED | `useCreateFundingSession`【F:src/lib/queries/sender.ts†L784-L825】 | Admin override not surfaced in UI. |
| POST /escrows/{escrow_id}/mark-delivered | docs/Backend_info/API_GUIDE (11).md | API key | sender | EscrowActionPayload | EscrowRead | USED | `useMarkDelivered`【F:src/lib/queries/sender.ts†L708-L776】 | Similar for client-approve/reject/check-deadline via same helper. |
| POST /escrows/{escrow_id}/milestones | docs/Backend_info/API_GUIDE (11).md | API key | admin/support/sender (draft only) | MilestoneCreate | MilestoneRead | USED | Sender/admin creation【F:src/lib/queries/sender.ts†L457-L506】【F:src/lib/queries/admin.ts†L820-L857】 | Sender UI loops create-per-milestone; no draft-state guard. |
| GET /escrows/{escrow_id}/milestones | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/admin/support | — | list[MilestoneRead] | USED | `useEscrowMilestones`【F:src/lib/queries/sender.ts†L581-L647】 | Polls while milestones in progress. |
| GET /escrows/milestones/{milestone_id} | docs/Backend_info/API_GUIDE (11).md | API key | admin/sender/provider | — | MilestoneRead | USED | `useMilestoneDetail`【F:src/lib/queries/sender.ts†L649-L676】 | — |
| POST /files/proofs | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin | multipart file | ProofFileUploadResponse | USED | `uploadProofFile` + ProofForm【F:src/lib/apiClient.ts†L110-L139】【F:src/components/sender/ProofForm.tsx†L100-L189】 | Client validates type/size; escrow_id optional. |
| POST /proofs | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin | ProofCreate | ProofRead | USED | `useCreateProof`【F:src/lib/queries/sender.ts†L1060-L1146】 | Sends milestone_idx/type/storage_url/sha256 + note metadata. |
| GET /proofs | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin/advisor | Query filters | PaginatedResponse[ProofDetailRead] | PARTIAL | Admin fallback counter only【F:src/lib/queries/admin.ts†L158-L179】 | Only used when `/admin/proofs/review-queue` fails; no UI list. |
| GET /proofs/{proof_id} | docs/Backend_info/API_GUIDE (11).md | API key | sender/provider/support/admin/advisor | — | ProofDetailRead | USED | Proof polling【F:src/lib/queries/sender.ts†L878-L1044】 | Drives post-submit status. |
| POST /proofs/{proof_id}/decision | docs/Backend_info/API_GUIDE (11).md | API key | sender/support/admin | ProofDecision | ProofRead | USED | `useAdminProofDecision`【F:src/lib/queries/admin.ts†L860-L915】 | Sender/provider decision UI absent. |
| POST /proofs/{proof_id}/request_advisor_review | docs/Backend_info/API_GUIDE (11).md | API key | sender | — | ProofRead | USED | `useRequestAdvisorReview`【F:src/lib/queries/sender.ts†L1148-L1189】 | Sender CTA only. |
| GET /admin/proofs/review-queue | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | Query limit/offset/advisor_id/unassigned | PaginatedResponse[ProofDetailRead] | USED | `useAdminProofReviewQueue`【F:src/lib/queries/admin.ts†L585-L623】 | Primary admin queue source. |
| GET /admin/fraud/score_comparison | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | Query filters | list | UNUSED | — | Fraud comparison dashboard missing. |
| GET /admin/risk-snapshots | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | Query filters | PaginatedResponse | UNUSED | — | Risk snapshots dashboard missing. |
| GET /admin/advisors/overview | docs/Backend_info/ADMIN_RUNBOOK (9).md | API key | admin/support | Query limit/offset | PaginatedResponse[AdminAdvisorListItem] | USED | `fetchAdvisorsOverview` / `useAdminAdvisorsOverview`【F:src/lib/adminApi.ts†L95-L120】【F:src/lib/queries/admin.ts†L625-L657】 | — |
| GET /admin/advisors | docs/Backend_info/API_GUIDE (11).md | API key | admin | Query active | list[AdvisorProfileRead] | USED | `useAdminAdvisorsList`【F:src/lib/queries/admin.ts†L659-L693】 | — |
| GET /admin/advisors/{advisor_id} | docs/Backend_info/API_GUIDE (11).md | API key | admin | — | AdvisorProfileRead | USED | `useAdminAdvisorDetail`【F:src/lib/queries/admin.ts†L916-L936】 | — |
| PATCH /admin/advisors/{advisor_id} | docs/Backend_info/API_GUIDE (11).md | API key | admin | AdvisorProfileUpdate | AdvisorProfileRead | USED | `useAdminUpdateAdvisor`【F:src/lib/queries/admin.ts†L938-L980】 | — |
| POST /admin/advisors | docs/Backend_info/API_GUIDE (11).md | API key | admin | AdvisorProfileCreate | AdvisorProfileRead | USED | `useAdminCreateAdvisor`【F:src/lib/queries/admin.ts†L982-L1010】 | — |
| POST /admin/advisors/{advisor_id}/assign-sender | docs/Backend_info/API_GUIDE (11).md | API key | admin | AssignSender payload | AdvisorSenderItem | USED | `useAdminAssignSender`【F:src/lib/queries/admin.ts†L1012-L1037】 | — |
| GET /advisor/me/profile | docs/Backend_info/API_GUIDE (11).md | API key | advisor | — | AdvisorProfileRead | USED | `useAdvisorProfile`【F:src/lib/queries/advisor.ts†L35-L73】 | Returns null on 404. |
| GET /advisor/me/proofs | docs/Backend_info/API_GUIDE (11).md | API key | advisor | Query status | list[AdvisorProofItem] | USED | `useAdvisorAssignedProofs`【F:src/lib/queries/advisor.ts†L9-L40】 | Polls until terminal. |
| POST /payments/execute/{payment_id} | docs/Backend_info/API_GUIDE (11).md | API key | admin/support | — | PaymentRead | USED | `useExecutePayment`【F:src/lib/queries/admin.ts†L325-L366】 | Non-idempotent; UI allows retries. |
| GET /admin/payments | docs/Backend_info/API_GUIDE (11).md | API key | admin/support | Query status/escrow_id/limit/offset | PaginatedResponse[PaymentRead] | USED (with extra filters) | `useAdminPayments`【F:src/lib/queries/admin.ts†L167-L215】 | Sends undocumented `payment_id`/`id` filters. |
| GET /admin/settings/ai-proof | docs/Backend_info/API_GUIDE (11).md | API key | admin | — | AiProofSetting | USED | `fetchAiProofSetting` / `useAiProofSetting`【F:src/lib/adminApi.ts†L95-L120】【F:src/lib/queries/admin.ts†L604-L620】 | — |
| POST /admin/settings/ai-proof | docs/Backend_info/API_GUIDE (11).md | API key | admin | AiProofSetting payload | AiProofSetting | USED | `updateAiProofSetting` / `useUpdateAiProofSetting`【F:src/lib/adminApi.ts†L106-L120】【F:src/lib/queries/admin.ts†L620-L623】 | — |
| POST /admin/pricing/reference/import-csv | docs/Backend_info/API_GUIDE (11).md | API key | pricing_admin/risk_admin | multipart CSV | ImportResponse | USED | `useUploadReferenceCsv`【F:src/lib/queries/pricingAdmin.ts†L1-L43】 | — |
| /admin/pricing/inflation (GET/POST/PUT/DELETE/upload-csv) | docs/Backend_info/API_GUIDE (11).md | API key | pricing_admin/risk_admin | InflationAdjustment payload/CSV | InflationAdjustment/List | USED | Pricing hooks【F:src/lib/queries/pricingAdmin.ts†L1-L120】 | Full CRUD + upload wired. |
| POST /sender/external-proof-tokens | docs/Backend_info/API_GUIDE (11).md | API key | sender/support/admin | ExternalProofTokenRequest | ExternalProofTokenResponse | USED | Issuer page【F:src/lib/queries/externalProofTokens.ts†L17-L49】【F:src/app/sender/escrows/[id]/external-proof-tokens/page.tsx†L115-L189】 | Builds share link with `?token=` (doc forbids query transport). |
| GET /sender/external-proof-tokens | docs/Backend_info/API_GUIDE (11).md | API key | sender/support/admin | Query escrow_id/milestone_idx/limit/offset | ExternalProofTokenList | USED | `useExternalProofTokensList`【F:src/lib/queries/externalProofTokens.ts†L39-L74】 | — |
| GET /sender/external-proof-tokens/{token_id} | docs/Backend_info/API_GUIDE (11).md | API key | sender/support/admin | — | ExternalProofTokenRead | USED | `useExternalProofTokenDetail`【F:src/lib/queries/externalProofTokens.ts†L76-L101】 | — |
| POST /sender/external-proof-tokens/{token_id}/revoke | docs/Backend_info/API_GUIDE (11).md | API key | sender/support/admin | — | ExternalProofTokenRead | USED | `useRevokeExternalProofToken`【F:src/lib/queries/externalProofTokens.ts†L103-L133】 | — |
| POST /external/files/proofs | docs/Backend_info/API_GUIDE (11).md | External token header | token only | multipart file | ExternalProofUploadResponse | USED | `uploadExternalProofFile` / `useExternalProofUpload`【F:src/lib/api/externalClient.ts†L15-L55】【F:src/lib/queries/external.ts†L18-L49】 | Header built from token; token captured from query string. |
| POST /external/proofs/submit | docs/Backend_info/API_GUIDE (11).md | External token header | token only | ExternalProofSubmit | ExternalProofSubmitResponse | USED | `submitExternalProof` / `useExternalProofSubmit`【F:src/lib/api/externalClient.ts†L57-L83】【F:src/lib/queries/external.ts†L51-L71】 | — |
| GET /external/escrows/summary | docs/Backend_info/API_GUIDE (11).md | External token header | token only | — | ExternalEscrowSummary | USED | `getExternalEscrowSummary` / `useExternalEscrowSummary`【F:src/lib/api/externalClient.ts†L85-L106】【F:src/lib/queries/external.ts†L8-L34】 | — |
| GET /external/escrows/{escrow_id} | docs/Backend_info/API_GUIDE (11).md | External token header | token only | — | ExternalEscrowSummary | UNUSED | — | Path variant not used. |
| GET /external/proofs/{proof_id}/status | docs/Backend_info/API_GUIDE (11).md | External token header | token only | — | ExternalProofStatusResponse | USED | `getExternalProofStatus` / `useExternalProofStatus`【F:src/lib/api/externalClient.ts†L108-L133】【F:src/lib/queries/external.ts†L73-L142】 | Polls with backoff/stop on terminal. |
| GET /alerts | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support | Query limit/offset | PaginatedResponse[AlertRead] | UNUSED | — | Alerts feed not present. |
| /spend endpoints (categories/merchants/allow/allowed/purchases/spend) | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin/support/sender | Spend payloads | Spend responses | UNUSED | — | Direct Pay/spend UIs absent. |
| /transactions endpoints (allowlist/certified/transactions create/read) | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key | admin | Transaction payloads | TransactionRead | UNUSED | — | Not wired. |
| /kct_public/* | docs/Backend_info/FRONTEND_API_GUIDE (12).md | API key + GOV/ONG user | sender/admin | Gov project schemas | ProjectRead/list | UNUSED | — | Public-sector UI absent. |
| GET /health | docs/Backend_info/API_GUIDE (11).md | Public | — | — | dict | UNUSED | — | Healthcheck not used by frontend. |

## Frontend calls not found in backend docs (shadow inventory)

| Frontend call pattern | Frontend call sites | Status | Notes |
| --- | --- | --- | --- |
| `/admin/payments` with `payment_id` / `id` filters | `useAdminPayments`【F:src/lib/queries/admin.ts†L195-L221】 | UNDOCUMENTED PARAMS | Docs list only `status`/`escrow_id`/`limit`/`offset`; extra filters may be ignored or fail validation. |
| Portal links including `?token=<external_token>` | External token issuer UI【F:src/app/sender/escrows/[id]/external-proof-tokens/page.tsx†L169-L189】 | UNDOCUMENTED/CONTRA DOC | Backend forbids query transport for external tokens; link format risks leakage even though headers are set later. |
| Admin views relying on sender `/escrows/{id}/summary` | Admin escrow summary hook【F:src/lib/queries/admin.ts†L734-L760】 | MISALIGNED ROUTE | Admin-specific summary endpoint exists but unused; sender redaction may hide PSP refs/AI data needed by ops. |
